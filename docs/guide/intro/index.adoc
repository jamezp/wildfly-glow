[[glow_introduction]]
## Introduction

WildFly Glow is an evolution of the WildFly link:https://docs.wildfly.org/galleon/[Galleon] provisioning tooling. 

The goal of this project is to offer tooling allowing to identify the set of Galleon Feature-packs and Layers that are required 
by your application. The entry-point of this discovery is your application.

### Automatic identification of WildFly Galleon Layers

Today, in order to trim a WildFly server to fit the application requirements, you have to first identify the 
set of WildFly Galleon link:https://docs.wildfly.org/30/Galleon_Guide.html#wildfly_galleon_layers[Layers] to use.

WildFly Glow identifies the Layers for you by scanning your application war (jar or ear) files. 

This application to Galleon Layers mapping is based on rules contained in WildFly Galleon Layers (Starting WildFly 29). 
These rules express the Java types and artifacts (XML descriptors, properties files, ...) 
that are bound to the usage of a given Galleon Layer. An example of rule can be found in the link:https://github.com/wildfly/wildfly/blob/30.0.0.Final/ee-feature-pack/galleon-shared/src/main/resources/layers/standalone/jaxrs/layer-spec.xml#L8[jaxrs] Layer.

Once the Layers are identified, the Galleon Feature-packs that define them are selected and included.

### Centralized knowledge of WildFly Galleon Feature-packs.

WildFly can be extended with additional Galleon Feature-packs (e.g.: datasources, gRPC, keycloak, cloud, myfaces, resteasy-spring, ...).

WildFly Glow has, per WildFly version, the knowledge of some compatible Galleon Feature-packs (this information is stored in 
link:https://github.com/wildfly/wildfly-galleon-feature-packs/tree/release[this] github project).

In order for these extras Feature-packs to be recognized by WildFly Glow, they must have their defined Layers annotated with rules.

### Going beyond discovered Galleon Layers

WildFly Glow does more than identifying Galleon Feature-packs and Layers.

#### Provisioning

WildFly Glow CLI allows you to provision a WildFly server, a WildFly Bootable JAR, produce a Docker image and deploy your application to OpenShift.

##### OpenShift provisioning

A good way to start with OpenShift is by using the link:https://developers.redhat.com/developer-sandbox[OpenShift Sandbox]. 
You can create a cluster in few clicks.

###### Pre-requisites

Once you have a custer up and running, there are few steps needed in order for WildFly Glow to log onto the cluster:

* Download the `oc` command from your cluster. Click on the `?` icon on the top right corner of the OpenShift admin console, then select `Command Line Tools`, 
then download `oc` for your platform.
* Retrieve the command to log to the Cluster. Click on your user name on the top right corner, 
then select `Copy login command`. This will open a page, copy the login command.
That should be something like: `oc login --token=sha256~ITC16QZxiVk5vm7NCdrRIx2yqvlB-L_6Wg-BrtIhnLE --server=https://api.sandbox-m3.1530.p1.openshiftapps.com:6443`

* Paste the login command in your terminal.

WildFly Glow can now interact with your cluster.

###### Deploying to OpenShift

That is done from the `wildfly-glow` command line tool. You can specify `--cloud --provision OPENSHIFT` to the `scan` command. For example:

`wildfly-glow scan examples/kitchensink.war --cloud --provision OPENSHIFT`

The kitchensink war file is analyzed, the Galleon configuration is generated, then both the war and the configuration are sent to OpenShift to start a server 
provisioning and create your application deployment.

At the end of the build, the application is deployed and the route to your application inside the cluster is printed. 
Use it to interact with your application.

###### Automatic deployment of PostGreSQL, MySQL, MariaDB, Artemis JMS Broker and Keycloak

If WildFly Glow detects the need for these technologies, it will automatically deploy the required servers and will bound the application to them.

This feature is currently specified by this link:https://github.com/wildfly/wildfly-glow/issues/49[GitHub Issue].

#### WildFly additional features discovery

Some WildFly server features can't be discovered by scanning application deployment. A good example is the usage of SSL to secure the http 
access. Another one is the need for WildFly tooling (e,g,: WildFly CLI, elytron tooling, ...). 
WildFly Glow allows you to include, according to what has been discovered in the deployment, a set of WildFly features called `add-ons` that makes sense 
for your application.

#### Connection to databases

WildFly Glow detects that your application requires a datasource and will suggest you with database `add-ons` to be included in order   
to connect to the DB of your choice (postgresql, mysql, ...).


### WildFly Glow tooling

WildFly Glow tooling is composed of 3 parts:

* A Command Line interface (`wildfly-glow` CLI) that scan your deployment and can provision a WildFly server, a WildFly Bootable JAR and 
a Docker image (to be deployed on Kubernetes). From the CLI you can discover the list of available `add-ons`, the list of WildFly server versions 
you can use (the latest WildFly major release being the default).

* An integration with the WildFly Maven plugin (Starting 5.0.0.Alpha2) `package` goal, to provision a WildFly server without specifying 
Feature-packs and Layers.

* A Maven plugin to scan Arquillian deployments in your tests and produce a `provisioning.xml` file that can be consumed by WildFly provisioning tooling.

